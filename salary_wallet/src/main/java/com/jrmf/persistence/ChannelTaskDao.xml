<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jrmf.persistence.ChannelTaskDao">

  <select id="selectByPrimaryKey" parameterType="java.lang.Integer"
    resultType="com.jrmf.domain.ChannelTask">
    select ct.*
    from channel_task ct
    where ct.id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    delete
    from channel_task
    where id = #{id,jdbcType=INTEGER}
  </delete>

  <insert id="insertSelective" parameterType="com.jrmf.domain.ChannelTask" useGeneratedKeys="true"
    keyColumn="id" keyProperty="id">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 29 09:42:59 CST 2020.
    -->
    insert into channel_task
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="customkey != null">
        customKey,
      </if>
      <if test="companyId != null">
        companyId,
      </if>
      <if test="taskName != null">
        taskName,
      </if>
      <if test="taskPartition != null">
        taskPartition,
      </if>
      <if test="website != null">
        website,
      </if>
      <if test="undertakerName != null">
        undertakerName,
      </if>
      <if test="undertakerCertId != null">
        undertakerCertId,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="statusDesc != null">
        statusDesc,
      </if>
      <if test="taskType != null">
        taskType,
      </if>
      <if test="taskDesc != null">
        taskDesc,
      </if>
      <if test="publishTime != null">
        publishTime,
      </if>
      <if test="startTime != null">
        startTime,
      </if>
      <if test="endTime != null">
        endTime,
      </if>
      <if test="unitPrice != null">
        unitPrice,
      </if>
      <if test="unitTab != null">
        unitTab,
      </if>
      <if test="taskAmount != null">
        taskAmount,
      </if>
      <if test="taskAchievement != null">
        taskAchievement,
      </if>
      <if test="achievementFee != null">
        achievementFee,
      </if>
      <if test="otherFee != null">
        otherFee,
      </if>
      <if test="commissionFee != null">
        commissionFee,
      </if>
      <if test="wordArea != null">
        wordArea,
      </if>
      <if test="parentId != null">
        parentId,
      </if>
      <if test="userId != null">
        userId,
      </if>
      <if test="linkPhoneNo != null">
        linkPhoneNo,
      </if>
      <if test="regionCode != null">
        regionCode,
      </if>
      <if test="regionName != null">
        regionName,
      </if>
      <if test="cityCode != null">
        cityCode,
      </if>
      <if test="cityName != null">
        cityName,
      </if>
      <if test="countyCode != null">
        countyCode,
      </if>
      <if test="countyName != null">
        countyName,
      </if>
      <if test="orderNo != null">
        orderNo,
      </if>
      <if test="paymentTime != null">
        paymentTime,
      </if>
      <if test="customOrderNo != null">
        customOrderNo,
      </if>
      <if test="payType != null">
        payType,
      </if>
      <if test="account != null">
        account,
      </if>
      <if test="bankName != null">
        bankName,
      </if>
      <if test="documentType != null">
        documentType,
      </if>
      <if test="limitNumber != null">
        limitNumber,
      </if>
      <if test="createTime != null">
        createTime,
      </if>
      <if test="lastUpdateTime != null">
        lastUpdateTime,
      </if>
      <if test="operatorName != null">
        operatorName,
      </if>
      <if test="startAmount != null">
        startAmount,
      </if>
      <if test="endAmount != null">
        endAmount,
      </if>
      <if test="bizType != null">
        biz_type,
      </if>
      <if test="ecoCateCode != null">
        eco_cate_code,
      </if>
      <if test="ecoCateLevelCode != null">
        eco_cate_level_code,
      </if>
      <if test="ecoCateName != null">
        eco_cate_name,
      </if>
      <if test="invoiceType != null">
        invoice_type,
      </if>
      <if test="contractFileUrl != null">
        contract_file_url,
      </if>
      <if test="invoiceCategoryName != null">
        invoice_category_name,
      </if>
      <if test="deletedFlag != null">
        deleted_flag,
      </if>
      <if test="fullEcoCateName != null">
        full_eco_cate_name,
      </if>
      <if test="fullInvoiceCategoryName != null">
       full_invoice_category_name,
      </if>
      <if test="invoiceDetail != null">
        invoice_detail
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="customKey != null">
        #{customKey,jdbcType=VARCHAR},
      </if>
      <if test="companyId != null">
        #{companyId,jdbcType=VARCHAR},
      </if>
      <if test="taskName != null">
        #{taskName,jdbcType=VARCHAR},
      </if>
      <if test="taskPartition != null">
        #{taskPartition,jdbcType=INTEGER},
      </if>
      <if test="website != null">
        #{website,jdbcType=VARCHAR},
      </if>
      <if test="undertakerName != null">
        #{undertakerName,jdbcType=VARCHAR},
      </if>
      <if test="undertakerCertId != null">
        #{undertakerCertId,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        #{status,jdbcType=INTEGER},
      </if>
      <if test="statusDesc != null">
        #{statusDesc,jdbcType=VARCHAR},
      </if>
      <if test="taskType != null">
        #{taskType,jdbcType=INTEGER},
      </if>
      <if test="taskDesc != null">
        #{taskDesc,jdbcType=VARCHAR},
      </if>
      <if test="publishTime != null">
        #{publishTime,jdbcType=VARCHAR},
      </if>
      <if test="startTime != null">
        #{startTime,jdbcType=VARCHAR},
      </if>
      <if test="endTime != null">
        #{endTime,jdbcType=VARCHAR},
      </if>
      <if test="unitPrice != null">
        #{unitPrice,jdbcType=VARCHAR},
      </if>
      <if test="unitTab != null">
        #{unitTab,jdbcType=VARCHAR},
      </if>
      <if test="taskAmount != null">
        #{taskAmount,jdbcType=VARCHAR},
      </if>
      <if test="taskAchievement != null">
        #{taskAchievement,jdbcType=VARCHAR},
      </if>
      <if test="achievementFee != null">
        #{achievementFee,jdbcType=VARCHAR},
      </if>
      <if test="otherFee != null">
        #{otherFee,jdbcType=VARCHAR},
      </if>
      <if test="commissionFee != null">
        #{commissionFee,jdbcType=VARCHAR},
      </if>
      <if test="wordArea != null">
        #{wordArea,jdbcType=VARCHAR},
      </if>
      <if test="parentId != null">
        #{parentId,jdbcType=INTEGER},
      </if>
      <if test="userId != null">
        #{userId,jdbcType=INTEGER},
      </if>
      <if test="linkPhoneNo != null">
        #{linkPhoneNo,jdbcType=VARCHAR},
      </if>
      <if test="regionCode != null">
        #{regionCode,jdbcType=VARCHAR},
      </if>
      <if test="regionName != null">
        #{regionName,jdbcType=VARCHAR},
      </if>
      <if test="cityCode != null">
        #{cityCode,jdbcType=VARCHAR},
      </if>
      <if test="cityName != null">
        #{cityName,jdbcType=VARCHAR},
      </if>
      <if test="countyCode != null">
        #{countyCode,jdbcType=VARCHAR},
      </if>
      <if test="countyName != null">
        #{countyName,jdbcType=VARCHAR},
      </if>
      <if test="orderNo != null">
        #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="paymentTime != null">
        #{paymentTime,jdbcType=VARCHAR},
      </if>
      <if test="customOrderNo != null">
        #{customOrderNo,jdbcType=VARCHAR},
      </if>
      <if test="payType != null">
        #{payType,jdbcType=INTEGER},
      </if>
      <if test="account != null">
        #{account,jdbcType=VARCHAR},
      </if>
      <if test="bankName != null">
        #{bankName,jdbcType=VARCHAR},
      </if>
      <if test="documentType != null">
        #{documentType,jdbcType=INTEGER},
      </if>
      <if test="limitNumber != null">
        #{limitNumber,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdateTime != null">
        #{lastUpdateTime,jdbcType=VARCHAR},
      </if>
      <if test="operatorName != null">
        #{operatorName,jdbcType=VARCHAR},
      </if>
      <if test="startAmount != null">
        #{startAmount,jdbcType=VARCHAR},
      </if>
      <if test="endAmount != null">
        #{endAmount,jdbcType=VARCHAR},
      </if>
      <if test="bizType != null">
        #{bizType,jdbcType=TINYINT},
      </if>
      <if test="ecoCateCode != null">
        #{ecoCateCode,jdbcType=VARCHAR},
      </if>
      <if test="ecoCateLevelCode != null">
        #{ecoCateLevelCode,jdbcType=VARCHAR},
      </if>
      <if test="ecoCateName != null">
        #{ecoCateName,jdbcType=VARCHAR},
      </if>
      <if test="invoiceType != null">
        #{invoiceType,jdbcType=TINYINT},
      </if>
      <if test="contractFileUrl != null">
        #{contractFileUrl,jdbcType=VARCHAR},
      </if>
      <if test="invoiceCategoryName != null">
        #{invoiceCategoryName,jdbcType=VARCHAR},
      </if>
      <if test="deletedFlag != null">
        #{deletedFlag},
      </if>
      <if test="fullEcoCateName != null">
        #{fullEcoCateName},
      </if>
      <if test="fullInvoiceCategoryName != null">
        #{fullInvoiceCategoryName},
      </if>
      <if test="invoiceDetail != null">
        #{invoiceDetail}
      </if>
    </trim>
  </insert>
  <insert id="insert" parameterType="com.jrmf.domain.ChannelTask">
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into channel_task (customKey, companyId, taskName,
    taskPartition, website, undertakerName,
    undertakerCertId, status, statusDesc,
    taskType, taskDesc, publishTime,
    startTime, endTime, unitPrice,
    unitTab, taskAmount, taskAchievement,
    achievementFee, otherFee, commissionFee,
    wordArea, parentId, userId,
    linkPhoneNo, regionCode, regionName,
    cityCode, cityName, countyCode,
    countyName,orderNo,paymentTime,customOrderNo,payType,account,bankName,
    documentType,limitNumber,createTime,lastUpdateTime,operatorName)
    values (#{customKey,jdbcType=VARCHAR}, #{companyId,jdbcType=VARCHAR},
    #{taskName,jdbcType=VARCHAR},
    #{taskPartition,jdbcType=INTEGER}, #{website,jdbcType=VARCHAR},
    #{undertakerName,jdbcType=VARCHAR},
    #{undertakerCertId,jdbcType=VARCHAR}, #{status,jdbcType=INTEGER},
    #{statusDesc,jdbcType=VARCHAR},
    #{taskType,jdbcType=INTEGER}, #{taskDesc,jdbcType=VARCHAR}, now(),
    now(), #{endTime,jdbcType=VARCHAR}, #{unitPrice,jdbcType=VARCHAR},
    #{unitTab,jdbcType=VARCHAR}, #{taskAmount,jdbcType=VARCHAR},
    #{taskAchievement,jdbcType=VARCHAR},
    #{achievementFee,jdbcType=VARCHAR}, #{otherFee,jdbcType=VARCHAR},
    #{commissionFee,jdbcType=VARCHAR},
    #{wordArea,jdbcType=VARCHAR}, #{parentId,jdbcType=INTEGER}, #{userId,jdbcType=INTEGER},
    #{linkPhoneNo,jdbcType=VARCHAR}, #{regionCode,jdbcType=VARCHAR}, #{regionName,jdbcType=VARCHAR},
    #{cityCode,jdbcType=VARCHAR}, #{cityName,jdbcType=VARCHAR}, #{countyCode,jdbcType=VARCHAR},
    #{countyName,jdbcType=VARCHAR},#{orderNo,jdbcType=VARCHAR},#{paymentTime,jdbcType=VARCHAR},
    #{customOrderNo,jdbcType=VARCHAR},#{payType,jdbcType=INTEGER},#{account,jdbcType=VARCHAR},#{bankName,jdbcType=VARCHAR},
    #{documentType,jdbcType=INTEGER},#{limitNumber,jdbcType=INTEGER},now(),
    now(),#{operatorName,jdbcType=VARCHAR})
  </insert>

  <update id="updateByPrimaryKeySelective" parameterType="com.jrmf.domain.ChannelTask">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 29 09:42:59 CST 2020.
    -->
    update channel_task
    <set>
      <if test="customkey != null">
        customkey = #{customkey,jdbcType=VARCHAR},
      </if>
      <if test="companyId != null">
        companyId = #{companyId,jdbcType=VARCHAR},
      </if>
      <if test="taskName != null">
        taskName = #{taskName,jdbcType=VARCHAR},
      </if>
      <if test="taskPartition != null">
        taskPartition = #{taskPartition,jdbcType=INTEGER},
      </if>
      <if test="website != null">
        website = #{website,jdbcType=VARCHAR},
      </if>
      <if test="undertakerName != null">
        undertakerName = #{undertakerName,jdbcType=VARCHAR},
      </if>
      <if test="undertakerCertId != null">
        undertakerCertId = #{undertakerCertId,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="statusDesc != null">
        statusDesc = #{statusDesc,jdbcType=VARCHAR},
      </if>
      <if test="taskType != null">
        taskType = #{taskType,jdbcType=INTEGER},
      </if>
      <if test="taskDesc != null">
        taskDesc = #{taskDesc,jdbcType=VARCHAR},
      </if>
      <if test="publishTime != null">
        publishTime = #{publishTime,jdbcType=VARCHAR},
      </if>
      <if test="startTime != null">
        startTime = #{startTime,jdbcType=VARCHAR},
      </if>
      <if test="endTime != null">
        endTime = #{endTime,jdbcType=VARCHAR},
      </if>
      <if test="unitPrice != null">
        unitPrice = #{unitPrice,jdbcType=VARCHAR},
      </if>
      <if test="unitTab != null">
        unitTab = #{unitTab,jdbcType=VARCHAR},
      </if>
      <if test="taskAmount != null">
        taskAmount = #{taskAmount,jdbcType=VARCHAR},
      </if>
      <if test="taskAchievement != null">
        taskAchievement = #{taskAchievement,jdbcType=VARCHAR},
      </if>
      <if test="achievementFee != null">
        achievementFee = #{achievementFee,jdbcType=VARCHAR},
      </if>
      <if test="otherFee != null">
        otherFee = #{otherFee,jdbcType=VARCHAR},
      </if>
      <if test="commissionFee != null">
        commissionFee = #{commissionFee,jdbcType=VARCHAR},
      </if>
      <if test="wordArea != null">
        wordArea = #{wordArea,jdbcType=VARCHAR},
      </if>
      <if test="parentId != null">
        parentId = #{parentId,jdbcType=INTEGER},
      </if>
      <if test="userId != null">
        userId = #{userId,jdbcType=INTEGER},
      </if>
      <if test="linkPhoneNo != null">
        linkPhoneNo = #{linkPhoneNo,jdbcType=VARCHAR},
      </if>
      <if test="regionCode != null">
        regionCode = #{regionCode,jdbcType=VARCHAR},
      </if>
      <if test="regionName != null">
        regionName = #{regionName,jdbcType=VARCHAR},
      </if>
      <if test="cityCode != null">
        cityCode = #{cityCode,jdbcType=VARCHAR},
      </if>
      <if test="cityName != null">
        cityName = #{cityName,jdbcType=VARCHAR},
      </if>
      <if test="countyCode != null">
        countyCode = #{countyCode,jdbcType=VARCHAR},
      </if>
      <if test="countyName != null">
        countyName = #{countyName,jdbcType=VARCHAR},
      </if>
      <if test="orderNo != null">
        orderNo = #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="paymentTime != null">
        paymentTime = #{paymentTime,jdbcType=VARCHAR},
      </if>
      <if test="customOrderNo != null">
        customOrderNo = #{customOrderNo,jdbcType=VARCHAR},
      </if>
      <if test="payType != null">
        payType = #{payType,jdbcType=INTEGER},
      </if>
      <if test="account != null">
        account = #{account,jdbcType=VARCHAR},
      </if>
      <if test="bankName != null">
        bankName = #{bankName,jdbcType=VARCHAR},
      </if>
      <if test="documentType != null">
        documentType = #{documentType,jdbcType=INTEGER},
      </if>
      <if test="limitNumber != null">
        limitNumber = #{limitNumber,jdbcType=INTEGER},
      </if>
      <if test="createTime != null">
        createTime = #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="operatorName != null">
        operatorName = #{operatorName,jdbcType=VARCHAR},
      </if>
      <if test="startAmount != null">
        startAmount = #{startAmount,jdbcType=VARCHAR},
      </if>
      <if test="endAmount != null">
        endAmount = #{endAmount,jdbcType=VARCHAR},
      </if>
      <if test="bizType != null">
        biz_type = #{bizType,jdbcType=TINYINT},
      </if>
      <if test="ecoCateCode != null">
        eco_cate_code = #{ecoCateCode,jdbcType=VARCHAR},
      </if>
      <if test="ecoCateLevelCode != null">
        eco_cate_level_code =#{ecoCateLevelCode,jdbcType=VARCHAR},
      </if>
      <if test="ecoCateName != null">
        eco_cate_name = #{ecoCateName,jdbcType=VARCHAR},
      </if>
      <if test="invoiceType != null">
        invoice_type = #{invoiceType,jdbcType=TINYINT},
      </if>
      <if test="contractFileUrl != null">
        contract_file_url =#{contractFileUrl,jdbcType=VARCHAR},
      </if>
      <if test="invoiceCategoryName != null">
        invoice_category_name = #{invoiceCategoryName,jdbcType=VARCHAR},
      </if>
      <if test="platsrl != null">
        platsrl = #{platsrl,jdbcType=VARCHAR},
      </if>
      <if test="bidno != null">
        bidno = #{bidno,jdbcType=VARCHAR},
      </if>
      <if test="deletedFlag != null">
        deleted_flag = #{deletedFlag},
      </if>
      lastUpdateTime = now()
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>


  <update id="updateByPrimaryKey" parameterType="com.jrmf.domain.ChannelTask">
    update channel_task
    set customKey        = #{customKey,jdbcType=VARCHAR},
        companyId        = #{companyId,jdbcType=VARCHAR},
        taskName         = #{taskName,jdbcType=VARCHAR},
        taskPartition    = #{taskPartition,jdbcType=INTEGER},
        website          = #{website,jdbcType=VARCHAR},
        undertakerName   = #{undertakerName,jdbcType=VARCHAR},
        undertakerCertId = #{undertakerCertId,jdbcType=VARCHAR},
        status           = #{status,jdbcType=INTEGER},
        statusDesc       = #{statusDesc,jdbcType=VARCHAR},
        taskType         = #{taskType,jdbcType=INTEGER},
        taskDesc         = #{taskDesc,jdbcType=VARCHAR},
        publishTime      = #{publishTime,jdbcType=VARCHAR},
        startTime        = #{startTime,jdbcType=VARCHAR},
        endTime          = #{endTime,jdbcType=VARCHAR},
        unitPrice        = #{unitPrice,jdbcType=VARCHAR},
        unitTab          = #{unitTab,jdbcType=VARCHAR},
        taskAmount       = #{taskAmount,jdbcType=VARCHAR},
        taskAchievement  = #{taskAchievement,jdbcType=VARCHAR},
        achievementFee   = #{achievementFee,jdbcType=VARCHAR},
        otherFee         = #{otherFee,jdbcType=VARCHAR},
        commissionFee    = #{commissionFee,jdbcType=VARCHAR},
        wordArea         = #{wordArea,jdbcType=VARCHAR},
        parentId         = #{parentId,jdbcType=INTEGER},
        userId           = #{userId,jdbcType=INTEGER},
        linkPhoneNo      = #{linkPhoneNo,jdbcType=VARCHAR},
        regionCode       = #{regionCode,jdbcType=VARCHAR},
        regionName       = #{regionName,jdbcType=VARCHAR},
        cityCode         = #{cityCode,jdbcType=VARCHAR},
        cityName         = #{cityName,jdbcType=VARCHAR},
        countyCode       = #{countyCode,jdbcType=VARCHAR},
        countyName       = #{countyName,jdbcType=VARCHAR},
        orderNo          = #{orderNo,jdbcType=VARCHAR},
        paymentTime      = #{paymentTime,jdbcType=VARCHAR},
        customOrderNo    = #{customOrderNo,jdbcType=VARCHAR},
        payType          = #{payType,jdbcType=INTEGER},
        account          = #{account,jdbcType=VARCHAR},
        bankName         = #{bankName,jdbcType=VARCHAR},
        documentType     = #{documentType,jdbcType=INTEGER},
        limitNumber      = #{limitNumber,jdbcType=INTEGER},
        lastUpdateTime   = now(),
        operatorName     = #{operatorName,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <select id="selectAll" resultType="com.jrmf.domain.ChannelTask">
    SELECT ct.*,ctt.typeName FROM channel_task ct left join channel_task_type ctt on
    ct.taskType=ctt.id
    <trim prefix=" where " suffixOverrides="and">
      <if test="customKey !=null and customKey !=''">
        ct.customKey = #{customKey} and
      </if>
      <if test="taskPartition !=null and taskPartition !=''">
        ct.taskPartition = #{taskPartition} and
      </if>
      <if test="startTime !=null and startTime !=''">
        date(ct.publishTime) &gt;= #{startTime} and
      </if>
      <if test="endTime !=null and endTime !=''">
        date(ct.publishTime) &lt;= #{endTime} and
      </if>
      <if test="startAmount !=null and startAmount !=''">
        cast(ct.taskAmount as decimal(15,2)) &gt;= #{startAmount} and
      </if>
      <if test="endAmount !=null and endAmount !=''">
        cast(ct.taskAmount as decimal(15,2)) &lt;= #{endAmount} and
      </if>
      <if test="parentId !=null and parentId !=''">
        ct.parentId = #{parentId} and
      </if>
      <if test="undertakerCertId !=null and undertakerCertId !=''">
        FIND_IN_SET(ct.undertakerCertId,#{undertakerCertId}) and
      </if>
      <if test="status !=null and status !=''">
        FIND_IN_SET(ct.status,#{status}) and
      </if>
      <if test="regionCode != null and regionCode !=''">
        FIND_IN_SET(ct.regionCode,#{regionCode}) and
      </if>
      <if test="taskType != null and taskType !=''">
        FIND_IN_SET(ct.taskType,#{taskType}) and
      </if>
      <if test="keyword != null and keyword !=''">
        ct.taskName like concat('%', #{keyword}, '%') and
      </if>
    </trim>
  </select>

  <update id="updateConfirmMatchTask" parameterType="com.jrmf.domain.ChannelTask">
    update channel_task
    set `status`=1
    where `status` = 9
      and taskPartition = 2
      and FIND_IN_SET(undertakerCertId, #{certIds})
  </update>

  <select id="selectResourceCustom" resultType="java.lang.String">
    select customKey from channel_task where taskPartition=5
    <if test="customKey !=null and customKey !=''">
      and FIND_IN_SET(customKey,#{customKey})
    </if>
    group by customKey;
  </select>

    <select id="selectCustomAll" resultType="com.jrmf.domain.ChannelTask">
        SELECT ct.*,ctt.typeName,cc.companyName customName,cc2.companyName FROM channel_task ct left join
        channel_task_type ctt on ct.taskType=ctt.id left join channel_custom cc on cc.customKey=ct.customKey left join
        channel_custom cc2 on cc2.customKey=ct.companyId
        <trim prefix=" where " suffixOverrides="and">
            <if test="getTaskList !=null and getTaskList !=''">
                ct.taskPartition in (2,3,4) and
            </if>
            <if test="taskPartition !=null and taskPartition !=''">
              ct.taskPartition = #{taskPartition} and
            </if>
            <if test="phoneNo !=null and phoneNo !=''">
                ct.linkPhoneNo = #{phoneNo} and
            </if>
            <if test="payType !=null and payType !=''">
              ct.payType = #{payType} and
            </if>
            <if test="customKey !=null and customKey !=''">
                FIND_IN_SET(ct.customKey,#{customKey}) and
            </if>
            <if test="userName != null and userName !=''">
                ct.undertakerName like concat('%', #{userName}, '%') and
            </if>
            <if test="startTime !=null and startTime !=''">
                date(ct.paymentTime) &gt;= #{startTime} and
            </if>
            <if test="endTime !=null and endTime !=''">
                date(ct.paymentTime) &lt;= #{endTime} and
            </if>
            <if test="customName != null and customName !=''">
                cc.companyName like concat('%', #{customName}, '%') and
            </if>
            <if test="account !=null and account !=''">
                ct.account like concat('%', #{account}, '%') and
            </if>
            <if test="companyId !=null and companyId !=''">
                cc2.customKey = #{companyId} and
            </if>
            <if test="certId !=null and certId !=''">
                ct.undertakerCertId like concat('%', #{certId}, '%') and
            </if>
            <if test="startAmount !=null and startAmount !=''">
                cast(ct.taskAmount as decimal(15,2)) &gt;= #{startAmount} and
            </if>
            <if test="endAmount !=null and endAmount !=''">
                cast(ct.taskAmount as decimal(15,2)) &lt;= #{endAmount} and
            </if>
            <if test="taskType != null and taskType !=''">
                ct.taskType = #{taskType} and
            </if>
            <if test="taskStatus !=null and taskStatus !=''">
                ct.status = #{taskStatus} and
            </if>
            <if test="taskName !=null and taskName !=''">
                ct.taskName like concat('%', #{taskName}, '%') and
            </if>
        </trim>
        order by id desc
        <if test="start !=null and limit !=null">
            limit #{start},#{limit}
        </if>
    </select>
    <select id="selectAllType" resultType="com.jrmf.domain.ChannelTaskType">
        select * from channel_task_type
    </select>

  <select id="selectResourceAll" resultType="com.jrmf.domain.ChannelTask">
    SELECT ct.*,ctt.typeName,cc.companyName customName FROM channel_task ct left join
    channel_task_type ctt on
    ct.taskType=ctt.id left join channel_custom cc on cc.customKey=ct.customKey
    <trim prefix=" where " suffixOverrides="and">
      <if test="getResourceTaskList !=null and getResourceTaskList !=''">
        ct.taskPartition in (1,5) and
      </if>
      <if test="customKey !=null and customKey !=''">
        FIND_IN_SET(ct.customKey,#{customKey}) and
      </if>
      <if test="companyId !=null and companyId !=''">
        ct.companyId = #{companyId} and
      </if>
      <if test="taskPartition !=null and taskPartition !=''">
        ct.taskPartition = #{taskPartition} and
      </if>
      <if test="startTime !=null and startTime !=''">
        date(ct.createTime) &gt;= #{startTime} and
      </if>
      <if test="endTime !=null and endTime !=''">
        date(ct.createTime) &lt;= #{endTime} and
      </if>
      <if test="customName != null and customName !=''">
        cc.companyName like concat('%', #{customName}, '%') and
      </if>
      <if test="startAmount !=null and startAmount !=''">
        cast(ct.unitPrice as decimal(15,2)) &gt;= #{startAmount} and
      </if>
      <if test="endAmount !=null and endAmount !=''">
        cast(ct.unitPrice as decimal(15,2)) &lt;= #{endAmount} and
      </if>
      <if test="taskType != null and taskType !=''">
        ct.taskType = #{taskType} and
      </if>
      <if test="taskName !=null and taskName !=''">
        ct.taskName like concat('%', #{taskName}, '%') and
      </if>
      <if test="regionCode !=null and regionCode !=''">
        ct.regionCode = #{regionCode} and
      </if>
      <if test="cityCode !=null and cityCode !=''">
        ct.cityCode = #{cityCode} and
      </if>
      <if test="countyCode !=null and countyCode !=''">
        ct.countyCode = #{countyCode} and
      </if>
      <if test="bizType !=null and bizType !=''">
        ct.biz_type = #{bizType} and
      </if>
      <if test="deletedFlag !=null">
        ct.deleted_flag = #{deletedFlag} and
      </if>
    </trim>
    order by lastUpdateTime desc
    <if test="start !=null and limit !=null">
      limit #{start},#{limit}
    </if>
  </select>

  <select id="selectByParentCode" resultType="com.jrmf.domain.ChannelAreas">
    select regionCode code, regionName name
    from channel_areas
    where parentRegionCode = #{parentCode}
  </select>

  <update id="updateTaskStatus">
    update channel_task
    set status         = #{status},
        lastUpdateTime = now()
    where id = #{id}
  </update>

  <select id="selectAutogenerateTaskAll" resultType="com.jrmf.domain.ChannelTask">
    SELECT ct.* FROM channel_task ct
    <trim prefix=" where " suffixOverrides="and">
      <if test="taskIds !=null and taskIds !=''">
        FIND_IN_SET(id,#{taskIds}) and
      </if>
      <if test="taskPartition !=null and taskPartition !=''">
        ct.taskPartition = #{taskPartition} and
      </if>
      <if test="customKey !=null and customKey !=''">
        ct.customKey = #{customKey} and
      </if>
      <if test="amount !=null and amount !=''">
        ((cast(startAmount as decimal(15,2)) &lt;= #{amount} and cast(endAmount as decimal(15,2))
        &gt;= #{amount})
        or (startAmount is null and endAmount is null)
        or ((endAmount is null and cast( startAmount as decimal ( 15, 2 ) ) &lt;= #{amount}))
        or ((startAmount is null and cast( endAmount as decimal ( 15, 2 ) ) &gt;= #{amount}))) and
      </if>
    </trim>
  </select>

  <select id="selectCustomAllCount" resultType="int">
    SELECT COUNT(1) FROM channel_task ct left join
    channel_task_type ctt on ct.taskType=ctt.id left join channel_custom cc on
    cc.customKey=ct.customKey left join
    channel_custom cc2 on cc2.customKey=ct.companyId
    <trim prefix=" where " suffixOverrides="and">
      <if test="getTaskList !=null and getTaskList !=''">
        ct.taskPartition in (2,3,4) and
      </if>
      <if test="customKey !=null and customKey !=''">
        FIND_IN_SET(ct.customKey,#{customKey}) and
      </if>
      <if test="userName != null and userName !=''">
        ct.undertakerName like concat('%', #{userName}, '%') and
      </if>
      <if test="taskPartition !=null and taskPartition !=''">
        ct.taskPartition = #{taskPartition} and
      </if>
      <if test="startTime !=null and startTime !=''">
        date(ct.paymentTime) &gt;= #{startTime} and
      </if>
      <if test="endTime !=null and endTime !=''">
        date(ct.paymentTime) &lt;= #{endTime} and
      </if>
      <if test="payType !=null and payType !=''">
        ct.payType = #{payType} and
      </if>
      <if test="customName != null and customName !=''">
        cc.companyName like concat('%', #{customName}, '%') and
      </if>
      <if test="account !=null and account !=''">
        ct.account like concat('%', #{account}, '%') and
      </if>
      <if test="companyId !=null and companyId !=''">
        cc2.customKey = #{companyId} and
      </if>
      <if test="certId !=null and certId !=''">
        ct.undertakerCertId like concat('%', #{certId}, '%') and
      </if>
      <if test="startAmount !=null and startAmount !=''">
        cast(ct.taskAmount as decimal(15,2)) &gt;= #{startAmount} and
      </if>
      <if test="endAmount !=null and endAmount !=''">
        cast(ct.taskAmount as decimal(15,2)) &lt;= #{endAmount} and
      </if>
      <if test="taskType != null and taskType !=''">
        ct.taskType = #{taskType} and
      </if>
      <if test="taskStatus !=null and taskStatus !=''">
        ct.status = #{taskStatus} and
      </if>
      <if test="taskName !=null and taskName !=''">
        ct.taskName like concat('%', #{taskName}, '%') and
      </if>
    </trim>
  </select>
</mapper>
